<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of lapack</title>
  <meta name="keywords" content="lapack">
  <meta name="description" content="LAPACK Call any LAPACK or BLAS function or subroutine.">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html &copy; 2005 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../m2html.css">
  <script type="text/javascript">
    if (top.frames.length == 0) { top.location = "../index.html"; };
  </script>
</head>
<body>
<a name="_top"></a>
<!-- menu.html src -->
<h1>lapack
&nbsp;&nbsp;<img src="../c.png" alt="Linux AMD Opteron" border="0" title="Linux AMD Opteron"></h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="box"><strong>LAPACK Call any LAPACK or BLAS function or subroutine.</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="box"><strong>function [varargout] = lapack(varargin); </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="fragment"><pre class="comment">LAPACK Call any LAPACK or BLAS function or subroutine.  
   C = LAPACK('FUNC', A1, A2, ...) 
   [R1, R2, ...] = LAPACK('FUNC', A1, A2, ...)
   calls the BLAS/LAPACK function named FUNC, passing it arguments
   A1, A2, ..., then returns the results in the cell array C or in
   the arguments R1, R2, ...

   PROTO = LAPACK('FUNC') returns the prototype for the BLAS/LAPACK
   function named FUNC as a string.

   [R1, R2, ...] = LAPACK(PROTO, A1, A2, ...)
   C = LAPACK(PROTO, A1, A2, ...)
   where PROTO is a string similar to that returned by LAPACK('FUNC').
   This form allows selection of a subset of the arguments to be
   returned.  It also allows using functions from a newer version of
   the BLAS/LAPACK libraries where the prototype is not known.

   The PROTO argument is a string of the form 'T=FUNC(T,T,T,...)',
   where T indicates the FORTRAN type of each argument to the routine
   as well as the type of any return value. Lowercase values indicate
   that this is an input value only, while uppercase values indicate
   that it is an output (and possibly also an input) value.  Valid
   values for T are

      T    FORTRAN Type       Acceptable Matlab Type
   --------------------------------------------------------------------------
     s,S - REAL               single, double*
     d,D - DOUBLE PRECISION   double*
     c,C - COMPLEX            single, complex single*, double, complex double 
     z,Z - COMPLEX*16         double, complex double*
     i,I - INTEGER            int32*, int64*, double, logical
     l,L - LOGICAL            int32*, int64, double, logical
     h,H - CHARACTER          char*
            * indicates the type that will be returned

   Even if the BLAS/LAPACK routine specifies something as an output,
   is is okay to specify it as input only (lowercase) if you are not
   interested in that result.

   The easiest place to find the descriptions of the arguments for
   BLAS/LAPACK functions is from the FORTRAN source code, which
   include comments that thoroughly describe each argument.  
   They are available through the LAPACKHELP command.

 Examples:

   Call the BLAS routine xDOT and xDOTC to compute inner product of X and Y
     dot = lapack('D=DDOT(i,d,i,d,i)', length(X), X, 1, Y, 1)
     dot = lapack('S=SDOT(i,s,i,s,i)', length(X), X, 1, Y, 1)
     dot = lapack('Z=zdotc(i,z,i,z,i)', length(X), X, 1, Y, 1)
   which are all equivalent to the Matlab expression
     dot = X'*Y
   the first lapack statement is also equivalent to
     C = lapack('ddot', length(X), X, 1, Y, 1);
     dot = C{1}

   Call the LAPACK routine DGESVD to compute the SVD of the m by n matrix X
     [m,n] = size(X);   % determine the dimensions of X
     C = lapack('dgesvd', 'A', 'A', m, n, X, m, zeros(n,1), ...
                zeros(m), m, zeros(n), n, zeros(5*m,1), 5*m, 0);
     [s,U,VT] = C{[7,8,10]};
     V = VT';
   which is equivalent to the Matlab expressions:
     [U,S,V] = svd(X);
     s = diag(S);
   equivalently we could specify a prototype for DGESVD:
     [s,U,VT] = lapack('DGESVD(h,h,i,i,d,i,D,D,i,D,i,d,i,i)', ...
                     'A', 'A', m, n, X, m, zeros(n,1), ...
                      zeros(m), m, zeros(n), n, zeros(5*m,1), 5*m, 0);
     V = VT';
   to see a description of what the arguments for DGESVD should be type:
     lapackhelp('dgesvd');

   Call the LAPACK function LSAME to compare two characters
     lapack('L=LSAME(h,h)', 'x', 'y')
   which is equivalent to the Matlab expression
     'x' == 'y'

   Call the BLAS routine DGEMM
     C = lapack('DGEMM',TRANSA,TRANSB,M,N,K,ALPHA,A,LDA,B,LDB,BETA,C,LDC);
   the cell array C will have 13 elements corresponding to the updated
   arguments passed to the DGEMM function.  To determine what each
   argument stands for, type lapackhelp('dgemm') in Matlab.

 See also <a href="lapackhelp.html" class="code" title="function lapackhelp(func)">LAPACKHELP</a>.</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../matlabicon.gif)">
<li><a href="lapack.html" class="code" title="function [varargout] = lapack(varargin);">lapack</a>	LAPACK Call any LAPACK or BLAS function or subroutine.</li></ul>
This function is called by:
<ul style="list-style-image:url(../matlabicon.gif)">
<li><a href="XGEQP3.html" class="code" title="function varargout = XGEQP3(A)">XGEQP3</a>	XGEQP3 A wrapper for calling lapack routines for QR factorization</li><li><a href="XORMQR.html" class="code" title="function varargout = XORMQR(SIDE,TRANS,A,tau,B,varargin)">XORMQR</a>	XORMQR  A wrapper for multiplying by Householder reflectors</li><li><a href="lapack.html" class="code" title="function [varargout] = lapack(varargin);">lapack</a>	LAPACK Call any LAPACK or BLAS function or subroutine.</li></ul>
<!-- crossreference -->



<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="fragment"><pre>0001 <a name="_sub0" href="#_subfunctions" class="code">function [varargout] = lapack(varargin);</a>
0002 <span class="comment">%LAPACK Call any LAPACK or BLAS function or subroutine.</span>
0003 <span class="comment">%   C = LAPACK('FUNC', A1, A2, ...)</span>
0004 <span class="comment">%   [R1, R2, ...] = LAPACK('FUNC', A1, A2, ...)</span>
0005 <span class="comment">%   calls the BLAS/LAPACK function named FUNC, passing it arguments</span>
0006 <span class="comment">%   A1, A2, ..., then returns the results in the cell array C or in</span>
0007 <span class="comment">%   the arguments R1, R2, ...</span>
0008 <span class="comment">%</span>
0009 <span class="comment">%   PROTO = LAPACK('FUNC') returns the prototype for the BLAS/LAPACK</span>
0010 <span class="comment">%   function named FUNC as a string.</span>
0011 <span class="comment">%</span>
0012 <span class="comment">%   [R1, R2, ...] = LAPACK(PROTO, A1, A2, ...)</span>
0013 <span class="comment">%   C = LAPACK(PROTO, A1, A2, ...)</span>
0014 <span class="comment">%   where PROTO is a string similar to that returned by LAPACK('FUNC').</span>
0015 <span class="comment">%   This form allows selection of a subset of the arguments to be</span>
0016 <span class="comment">%   returned.  It also allows using functions from a newer version of</span>
0017 <span class="comment">%   the BLAS/LAPACK libraries where the prototype is not known.</span>
0018 <span class="comment">%</span>
0019 <span class="comment">%   The PROTO argument is a string of the form 'T=FUNC(T,T,T,...)',</span>
0020 <span class="comment">%   where T indicates the FORTRAN type of each argument to the routine</span>
0021 <span class="comment">%   as well as the type of any return value. Lowercase values indicate</span>
0022 <span class="comment">%   that this is an input value only, while uppercase values indicate</span>
0023 <span class="comment">%   that it is an output (and possibly also an input) value.  Valid</span>
0024 <span class="comment">%   values for T are</span>
0025 <span class="comment">%</span>
0026 <span class="comment">%      T    FORTRAN Type       Acceptable Matlab Type</span>
0027 <span class="comment">%   --------------------------------------------------------------------------</span>
0028 <span class="comment">%     s,S - REAL               single, double*</span>
0029 <span class="comment">%     d,D - DOUBLE PRECISION   double*</span>
0030 <span class="comment">%     c,C - COMPLEX            single, complex single*, double, complex double</span>
0031 <span class="comment">%     z,Z - COMPLEX*16         double, complex double*</span>
0032 <span class="comment">%     i,I - INTEGER            int32*, int64*, double, logical</span>
0033 <span class="comment">%     l,L - LOGICAL            int32*, int64, double, logical</span>
0034 <span class="comment">%     h,H - CHARACTER          char*</span>
0035 <span class="comment">%            * indicates the type that will be returned</span>
0036 <span class="comment">%</span>
0037 <span class="comment">%   Even if the BLAS/LAPACK routine specifies something as an output,</span>
0038 <span class="comment">%   is is okay to specify it as input only (lowercase) if you are not</span>
0039 <span class="comment">%   interested in that result.</span>
0040 <span class="comment">%</span>
0041 <span class="comment">%   The easiest place to find the descriptions of the arguments for</span>
0042 <span class="comment">%   BLAS/LAPACK functions is from the FORTRAN source code, which</span>
0043 <span class="comment">%   include comments that thoroughly describe each argument.</span>
0044 <span class="comment">%   They are available through the LAPACKHELP command.</span>
0045 <span class="comment">%</span>
0046 <span class="comment">% Examples:</span>
0047 <span class="comment">%</span>
0048 <span class="comment">%   Call the BLAS routine xDOT and xDOTC to compute inner product of X and Y</span>
0049 <span class="comment">%     dot = lapack('D=DDOT(i,d,i,d,i)', length(X), X, 1, Y, 1)</span>
0050 <span class="comment">%     dot = lapack('S=SDOT(i,s,i,s,i)', length(X), X, 1, Y, 1)</span>
0051 <span class="comment">%     dot = lapack('Z=zdotc(i,z,i,z,i)', length(X), X, 1, Y, 1)</span>
0052 <span class="comment">%   which are all equivalent to the Matlab expression</span>
0053 <span class="comment">%     dot = X'*Y</span>
0054 <span class="comment">%   the first lapack statement is also equivalent to</span>
0055 <span class="comment">%     C = lapack('ddot', length(X), X, 1, Y, 1);</span>
0056 <span class="comment">%     dot = C{1}</span>
0057 <span class="comment">%</span>
0058 <span class="comment">%   Call the LAPACK routine DGESVD to compute the SVD of the m by n matrix X</span>
0059 <span class="comment">%     [m,n] = size(X);   % determine the dimensions of X</span>
0060 <span class="comment">%     C = lapack('dgesvd', 'A', 'A', m, n, X, m, zeros(n,1), ...</span>
0061 <span class="comment">%                zeros(m), m, zeros(n), n, zeros(5*m,1), 5*m, 0);</span>
0062 <span class="comment">%     [s,U,VT] = C{[7,8,10]};</span>
0063 <span class="comment">%     V = VT';</span>
0064 <span class="comment">%   which is equivalent to the Matlab expressions:</span>
0065 <span class="comment">%     [U,S,V] = svd(X);</span>
0066 <span class="comment">%     s = diag(S);</span>
0067 <span class="comment">%   equivalently we could specify a prototype for DGESVD:</span>
0068 <span class="comment">%     [s,U,VT] = lapack('DGESVD(h,h,i,i,d,i,D,D,i,D,i,d,i,i)', ...</span>
0069 <span class="comment">%                     'A', 'A', m, n, X, m, zeros(n,1), ...</span>
0070 <span class="comment">%                      zeros(m), m, zeros(n), n, zeros(5*m,1), 5*m, 0);</span>
0071 <span class="comment">%     V = VT';</span>
0072 <span class="comment">%   to see a description of what the arguments for DGESVD should be type:</span>
0073 <span class="comment">%     lapackhelp('dgesvd');</span>
0074 <span class="comment">%</span>
0075 <span class="comment">%   Call the LAPACK function LSAME to compare two characters</span>
0076 <span class="comment">%     lapack('L=LSAME(h,h)', 'x', 'y')</span>
0077 <span class="comment">%   which is equivalent to the Matlab expression</span>
0078 <span class="comment">%     'x' == 'y'</span>
0079 <span class="comment">%</span>
0080 <span class="comment">%   Call the BLAS routine DGEMM</span>
0081 <span class="comment">%     C = lapack('DGEMM',TRANSA,TRANSB,M,N,K,ALPHA,A,LDA,B,LDB,BETA,C,LDC);</span>
0082 <span class="comment">%   the cell array C will have 13 elements corresponding to the updated</span>
0083 <span class="comment">%   arguments passed to the DGEMM function.  To determine what each</span>
0084 <span class="comment">%   argument stands for, type lapackhelp('dgemm') in Matlab.</span>
0085 <span class="comment">%</span>
0086 <span class="comment">% See also LAPACKHELP.</span>
0087 
0088 <span class="comment">%   Copyright 2007-2009, Timothy Toolan, University of Rhode Island</span>
0089 
0090 <span class="comment">% If we are in this function, then an appropriate compiled version</span>
0091 <span class="comment">% does not exist, so ask the user if they want to build one.</span>
0092 reply = input([<span class="string">'The function ''lapack'' requires a compiled mex version, '</span> <span class="keyword">...</span>
0093                <span class="string">'create now? (Y/n): '</span>], <span class="string">'s'</span>);
0094 
0095 <span class="keyword">if</span> (isempty(reply) || strcmpi(reply(1), <span class="string">'y'</span>))
0096   <span class="comment">% To ensure the compiled version has a higher precedence than this</span>
0097   <span class="comment">% m-file, it should be placed in the directory where this m-file</span>
0098   <span class="comment">% resides.  We will also assume the C source file resides there.</span>
0099   [dir, name, ext] = fileparts(which(<span class="string">'lapack'</span>));
0100   <span class="keyword">if</span> (~length(dir) || ~strcmpi(name, <span class="string">'lapack'</span>))
0101     error(<span class="string">'Could not determine directory containing this script (lapack.m).'</span>);
0102   <span class="keyword">end</span>
0103 
0104   <span class="comment">% On UNIX, we need to link to the library 'libdl' to allow runtime</span>
0105   <span class="comment">% linking to the internal Matlab LAPACK and BLAS functions.</span>
0106   libs = <span class="string">''</span>;
0107   <span class="keyword">if</span> (isunix) 
0108     libs = <span class="string">'-ldl'</span>; 
0109   <span class="keyword">end</span>
0110   
0111   largedims = <span class="string">''</span>;
0112   [arch, maxsize] = computer;
0113   <span class="keyword">if</span> (maxsize &gt; 2^31)
0114     largedims = <span class="string">'-largeArrayDims'</span>;
0115   <span class="keyword">end</span>
0116   
0117   <span class="comment">% Build the executable in the directory that contains this m-file.</span>
0118   olddir = pwd;
0119   cd(dir);
0120   <span class="keyword">try</span>
0121     eval([<span class="string">'mex '</span> largedims <span class="string">' '</span> libs  <span class="string">' lapack.c'</span>]); 
0122   <span class="keyword">catch</span> exception
0123     cd(olddir);
0124     rethrow(exception);
0125   <span class="keyword">end</span>
0126   cd(olddir);
0127   
0128   <span class="comment">% Verify that we sucessfully created the mex file before we try to call it.</span>
0129   [dir, name, ext] = fileparts(which(<span class="string">'lapack'</span>));
0130   <span class="keyword">if</span> (~strcmpi(name, <span class="string">'lapack'</span>) || ~strcmpi(ext, [<span class="string">'.'</span> mexext]))
0131     error([<span class="string">'Could not create the compiled version of ''lapack''.'</span> <span class="keyword">...</span>
0132            <span class="string">'  Try creating manually.'</span>]);
0133   <span class="keyword">end</span>
0134   
0135   <span class="comment">% Call the newly compiled function.</span>
0136   [varargout{1:nargout}] = <a href="lapack.html" class="code" title="function [varargout] = lapack(varargin);">lapack</a>(varargin{:});
0137 <span class="keyword">else</span>
0138   <span class="comment">% If the user pressed 'n' to complation, so throw an error.</span>
0139   error(<span class="string">'Please create a compiled mex version of the function ''lapack''.'</span>);
0140 <span class="keyword">end</span>
0141 
0142 
0143 
0144</pre></div>
<hr><address>Generated on Fri 21-Apr-2017 13:38:46 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/" target="_parent">m2html</a></strong> &copy; 2005</address>
</body>
</html>